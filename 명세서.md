

# User 관리

> Staff→ 상담사&관리자 , Desk → 데스크(=관광객)
> 

## 1. 회원가입/로그인 기능

| 순번 | 카테고리(분류) | 기능명 | 기능설명 | 데이타(파라미터) | 응답데이터 | 담당자 |
| --- | --- | --- | --- | --- | --- | --- |
| 1 |  |  |  |  |  |  |
| 2 |  |  |  |  |  |  |
|  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |

### 필수

1. 상담사
    - 회원가입
        - 처음 상담사가 회원가입하면 보류상태이고 이를 관리자가 승인해야 활성화됨
        - 회원정보(상담사)
            - user_name: 계정 아이디 - **수정불가**
            - password: 계정 비밀번호
            - name: 이름 (ex. admin1, 홍대안내데스크1)
            - area_id: 지역코드
            - Phone: 전화번호
            - Email: 이메일
            - is_admin: 관리자인지 나타내는 컬럼
            - is_deleted: 계정 탈퇴한 여부
            - is_approved: 승인된 계정인지 나타내는 컬림
            - approved_at: 승인된 날짜
            - created_date: 계정이 생성된 날짜
            - updated_date: 계정이 수정된 날짜
    - 로그인/로그아웃
        - 로그인
            - 상담사 / 데스크 로그인 페이지 통합
                - 데스크 로그인을 크게, 상담사 로그인/회원가입을 작게
            - 토큰 유지 기간
                - 상담사: 하루 정도
                - 데스크: 9999년
        - 로그아웃
            - 상담사: logout버튼 누르면 바로 로그아웃
            - 데스크: 데스크 메인 페이지의 오른쪽 아래 로그아웃 버튼을 누르면 modal창이 뜨고, modal창에서 비밀번호를 맞게 입력해야만 로그아웃 가능
    - 프로필 수정
2. 데스크
    - 회원가입
        - 관리자가 관리자 페이지에서 데스크 계정을 생성함
        - 회원정보(데스크)
            - user_name: 계정 아이디
            - password: 계정 비밀번호
            - name: 이름 (ex. 홍대안내데스크1)
            - created_date: 계정이 생성된 날짜
            - updated_date: 계정이 수정된 날짜
            - latitude: 위도
            - altitude: 경도
            - area_id: 지역코드

1. 관리자
    - 로그인/로그아웃
    - 회원관리
        - 상담사 회원정보 CRUD 가능
        - 데스크 계정 CRUD 가능
        - 지역 테이블 CRUD 가능
    - 지역 테이블 관리
        - 지역코드, 지역이름, 위치좌표정보

### 심화

- 관리자
    - 회원관리
        - 상담사 목록 조회 (전체조회, 특정인 검색, 지역별 필터링)
    - 마이페이지
        - 개인정보 조회, 수정
    - 공지사항crud (직원과 관리자만 볼수있는 공지사항 페이지)

## 2. 상담사 메인페이지

### 필수

[[Spring + SSE] Server-Sent Events를 이용한 실시간 알림](https://velog.io/@max9106/Spring-SSE-Server-Sent-Events%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EC%8B%A4%EC%8B%9C%EA%B0%84-%EC%95%8C%EB%A6%BC)

- 알람: 화상상담으로 연결 (SSE)
    - 새로고침 없이 어떻게 구현? AJAX?
- 상담내역 목록조회(일시, 지역, 상담시작시간, 상담종료시간)

### 심화

- 현재시간 표시(필요한지?)
- 상담내역 목록조회(고객의 평점)
- 상담세부 내용 확인(목록 중 하나를 클릭해서 세부 내용을 확인할게 있을까??)
    
    → 상담 저장 기록 확인
    
- 상담사 개인정보 조회, 수정(이름, 이메일)
- 채팅기록 저장

## 3. 상담사 프로필 페이지

- 프로필 CRUD 가능
    - 일단 계정삭제는 뺐음. 관리자만 계정 삭제 가능.

---

# 기능

> 관광객이 실제 사용하는 기능
> 

## 1. 화상 상담 기능

### 필수

- 상대방 화면 출력
- 본인 화면 출력
- 채팅창 기능 구현
- 지도 화면 공유 (WebRTC) → api를 이용하여 구글 맵등을 띄우고 위에 마크등으로 표시 기능??
    
                             → 혹은 특정 png 파일을 이용(인포 데스크 위치 고정) 마크로 위치를 안내
    
- 종료하기 버튼 활성화
    - X표시 버튼을 누르면 ‘상담을 종료하시겠습니까(예/아니오)’ modal창이 활성화.
    - 상담사는 취객 및 폭언 등에 대해 대응할 수 있음
    - 관광객은 대기중에 종료할 수 있음
- 운영 시간 제한 ( 정해진 날짜 및 시간대에만 활성화)

### 심화

- 평가 완료 후 사용자가 상담사에게 평점을 줄 수 있는 기능
- 상담 녹화 기능
- 대기 시간 표시

## 2. 매칭

![화상상담_시나리오.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/3ece4347-b830-47cd-8a3a-bbe5a6c8aedd/화상상담_시나리오.png)

### 필수

- 관광객이 호출 버튼을 클릭시 화상상담 방이 열리고 알람을 해당 구역을 담당하는 상담사에게 방이 열렸다는 알람을 전송
- 상담사에게 알람이 오면 알람 아이콘에 변화가 생김
- 상담사가 알람 아이콘을 클릭하면 화상상담 연결하겠냐는 모달이 나옴
- 모달에서 연결하겠다는 버튼 “예”를 누르면 화상상담 연결, “보류”를 누르면 연결X
- 화상상담이 연결되면, 방의 정원이 차서 다른 상담사들이 매칭된 상담사와 거의 동시에 “예”를 눌러도 들어오지 못하고 이미 연결되었다는 메시지가 뜸
- 화상상담이 연결되면, (알림이 갔었던)상담사들 모두에게 해당 상담이 이미 매칭 되었다는 정보를 알림 아이콘에 업데이트

### 심화

- 한 구역에서 상담 요청이 밀렸을 경우 전체 상담사에게 알림 전송

## 3. 게시판 기능

### 필수

- 데스크 메인페이지에서 게시판 영역을 클릭하면 게시판 페이지로 이동
- 게시판에 간단한 글 작성 ( 포스트잇처럼)
    - 컬럼: 제목, 내용, password, 작성일
- 당일 날짜의 포스트만 상단에 보이도록 설정
- 포스트잇으로 구현해야하므로, 표시되는 글자 제한(길어지면 ...으로 생략해서 보여주기, 최대 50글자? → 하면서 조절 필요)
- 해당 기능을 여행객이 이용하여 여행친구를 구하거나 하고싶은 말을 하는 일종의 담벼락 느낌
- 포스트잇 클릭하면 모달창 띄우기 → 내용을 다 볼 수 있도록
- 수정 및 삭제
    - 관리자는 수정 및 삭제 가능
    - 관광객은 게시글마다 비밀번호 설정.
- 상담시간과 별개로 24시간 활성화

### 심화

- 원하는 위치에 포스트잇 위치 (리코타 보드처럼 위치 정보 포함)
- 검색 기능 (날짜, 내용)
- 욕설 포함된 게시글은 저장이 안되도록 방지

---

# 상담사 및 직원만 사용하는 기능

## 필수

### 관리자 페이지

## 심화

### 공지사항 기능

- 공지사항 게시판을 열람 가능 → ( 회원가입한 User 즉 , 상담사를 지칭)
- 해당 게시판은 User 가 열람 가능 ,  Admin 만 수정 및 삭제 가능
- 파일 업로드/다운로드 ?

## 사용자 데스크탑 로그인/로그아웃

### 심화

- 브라우저가 꺼져도 계속 유지 가능? → User의 범위를 어떻게 잡는가에 따라 구현 여부를 결정.
